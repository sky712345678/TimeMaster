<meta charset="utf-8">
<title>Recent</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link type="text/css" rel="stylesheet" href="{{ url_for('static', filename='chart.css') }}"/>    
<body>
    <a href="/home" title="go to Homepage">&lt; Go back home</a>
    <h1>Recent activity</h1>
    <!-- 調整大小參考 https://www.chartjs.org/docs/latest/configuration/responsive.html -->
    <div class="chart-container" style="position: relative; height:20vh; width:40vw">
        <canvas id="myChart"></canvas>
    </div>
    
    
</body>
<!-- jinja2 一些傳遞限制語法 https://hackmd.io/@shaoeChen/SJ0X-PnkG?type=view -->
<script>
            const time_record = {{time_record|tojson}};
            console.log(Object.keys(time_record).length)
            var test = []
            for (const [key, value] of Object.entries(time_record)) {
                var random_color = "#" + ((1<<24)*Math.random() | 0).toString(16)
                test = test.concat({
                    label: key,
                    backgroundColor: random_color,
                    borderColor: random_color,
                    data: value,
                });
                console.log(key, value);
            }
            console.log(test);
            const label = {{date|tojson}};
            var data = {
                labels: label,
                datasets: test
            };

            const config = {
                type: 'line',
                data: data,
                options: {
                    scales: {
                        
                        x: {
                            ticks: {
                                // Include a dollar sign in the ticks
                                callback: function(val, index) {
                                    // Hide the label of every 2nd dataset
                                    return index % 2 === 0 ? this.getLabelForValue(val) : '';
                                },
                                color: 'black',
                            }
                        }                
                    }
                }
            };

            var myChart = new Chart(
                document.getElementById('myChart'),
                config,
            );

</script>